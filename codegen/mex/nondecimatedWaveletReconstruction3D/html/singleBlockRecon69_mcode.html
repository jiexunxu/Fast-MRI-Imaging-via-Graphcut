<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,22">22</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,23">23</a></span><span class="line"><span class="comment">% Conv in z, y, x direction with w1, w2, w3</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24">24</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S24T21U317">B</span>=singleBlockRecon(<span class="var type1" id="S25T13U320">A</span>, <span class="mxinfo" id="T1:U3"><span class="mxinfo" id="T1:U4"><span class="var type1" id="S26T1U321">w1</span></span></span>, <span class="mxinfo" id="T1:U6"><span class="mxinfo" id="T1:U7"><span class="var type1" id="S27T1U322">w2</span></span></span>, <span class="mxinfo" id="T1:U9"><span class="mxinfo" id="T1:U10"><span class="var type1" id="S28T1U323">w3</span></span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,25">25</a></span><span class="line">    <span class="mxinfo" id="T5:U12">[<span class="var type1" id="S29T5U327">m</span>, <span class="var type1" id="S30T5U328">n</span>, <span class="var type1" id="S31T5U329">p</span>]=size(<span class="var type1" id="S25T13U332">A</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,26">26</a></span><span class="line">    <span class="mxinfo" id="T5:U17"><span class="var type1" id="S33T5U335">q</span>=<span class="mxinfo" id="T5:U19">length(<span class="var type1" id="S26T1U338">w1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27">27</a></span><span class="line">    <span class="mxinfo" id="T21:U21"><span class="var type1" id="S24T21U341">B</span>=<span class="mxinfo" id="T21:U23">complex(<span class="mxinfo" id="T14:U24">zeros(<span class="var type1" id="S29T5U348">m</span>+<span class="var type1" id="S33T5U349">q</span>-1, <span class="var type1" id="S30T5U353">n</span>+<span class="var type1" id="S33T5U354">q</span>-1, <span class="mxinfo" id="T5:U29"><span class="mxinfo" id="T5:U30"><span class="var type1" id="S31T5U358">p</span>+<span class="var type1" id="S33T5U359">q</span></span>-<span class="mxinfo" id="T5:U33">1</span></span>)</span>, <span class="mxinfo" id="T5:U34">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,28">28</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S37T5U364">i</span>=<span class="mxinfo" id="T5:U36">1</span>:<span class="mxinfo" id="T5:U37"><span class="var type1" id="S29T5U367">m</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29">29</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S38T5U370">j</span>=<span class="mxinfo" id="T5:U40">1</span>:<span class="mxinfo" id="T5:U41"><span class="var type1" id="S30T5U373">n</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30">30</a></span><span class="line">            <span class="mxinfo" id="T19:U43"><span class="var type1" id="S39T19U376">v</span>=<span class="mxinfo" id="T19:U45">conv(<span class="mxinfo" id="T19:U46">squeeze(<span class="mxinfo" id="T15:U47"><span class="var type1" id="S25T13U382">A</span>(<span class="var type1" id="S37T5U383">i</span>, <span class="var type1" id="S38T5U384">j</span>, <span class="mxinfo" id="T31:U51">:</span>)</span>)</span>, <span class="var type1" id="S26T1U386">w1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31">31</a></span><span class="line">            <span class="mxinfo" id="T15:U53"><span class="mxinfo" id="T15:U54"><span class="var type1" id="S24T21U390">B</span>(<span class="var type1" id="S37T5U391">i</span>, <span class="var type1" id="S38T5U392">j</span>, <span class="mxinfo" id="T31:U58">:</span>)</span>=<span class="var type1" id="S39T19U394">v</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32">32</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33">33</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34">34</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,35">35</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S37T5U397">i</span>=<span class="mxinfo" id="T5:U61">1</span>:<span class="mxinfo" id="T5:U62"><span class="var type1" id="S29T5U400">m</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36">36</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S42T5U403">k</span>=<span class="mxinfo" id="T5:U65">1</span>:<span class="mxinfo" id="T5:U66"><span class="mxinfo" id="T5:U67"><span class="var type1" id="S31T5U408">p</span>+<span class="var type1" id="S33T5U409">q</span></span>-<span class="mxinfo" id="T5:U70">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37">37</a></span><span class="line">            <span class="mxinfo" id="T24:U71"><span class="var type1" id="S39T24U413">v</span>=<span class="mxinfo" id="T24:U73">conv(<span class="mxinfo" id="T22:U74">squeeze(<span class="mxinfo" id="T22:U75"><span class="var type1" id="S24T21U419">B</span>(<span class="var type1" id="S37T5U420">i</span>, <span class="mxinfo" id="T32:U78"><span class="mxinfo" id="T5:U79">1</span>:<span class="mxinfo" id="T5:U80"><span class="var type1" id="S30T5U423">n</span></span></span>, <span class="var type1" id="S42T5U424">k</span>)</span>)</span>, <span class="mxinfo" id="T1:U83"><span class="var type1" id="S27T1U425">w2</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38">38</a></span><span class="line">            <span class="mxinfo" id="T24:U85"><span class="mxinfo" id="T24:U86"><span class="var type1" id="S24T21U429">B</span>(<span class="var type1" id="S37T5U430">i</span>, <span class="mxinfo" id="T33:U89">:</span>, <span class="var type1" id="S42T5U432">k</span>)</span>=<span class="var type1" id="S39T24U433">v</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39">39</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40">40</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41">41</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,42">42</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S38T5U436">j</span>=<span class="mxinfo" id="T5:U93">1</span>:<span class="mxinfo" id="T5:U94"><span class="var type1" id="S30T5U441">n</span>+<span class="var type1" id="S33T5U442">q</span>-1</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43">43</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S42T5U446">k</span>=<span class="mxinfo" id="T5:U98">1</span>:<span class="mxinfo" id="T5:U99"><span class="mxinfo" id="T5:U100"><span class="var type1" id="S31T5U451">p</span>+<span class="var type1" id="S33T5U452">q</span></span>-<span class="mxinfo" id="T5:U103">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44">44</a></span><span class="line">            <span class="mxinfo" id="T26:U104"><span class="var type1" id="S39T26U456">v</span>=<span class="mxinfo" id="T26:U106">conv(<span class="mxinfo" id="T25:U107">squeeze(<span class="mxinfo" id="T25:U108"><span class="var type1" id="S24T21U462">B</span>(<span class="mxinfo" id="T34:U110"><span class="mxinfo" id="T5:U111">1</span>:<span class="mxinfo" id="T5:U112"><span class="var type1" id="S29T5U465">m</span></span></span>, <span class="var type1" id="S38T5U466">j</span>, <span class="var type1" id="S42T5U467">k</span>)</span>)</span>, <span class="mxinfo" id="T1:U116"><span class="var type1" id="S28T1U468">w3</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45">45</a></span><span class="line">            <span class="mxinfo" id="T26:U118"><span class="mxinfo" id="T26:U119"><span class="var type1" id="S24T21U472">B</span>(<span class="mxinfo" id="T35:U121">:</span>, <span class="var type1" id="S38T5U474">j</span>, <span class="var type1" id="S42T5U475">k</span>)</span>=<span class="var type1" id="S39T26U476">v</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46">46</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,47">47</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48">48</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
