<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,29">29</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,30">30</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S31T22U326">B</span>=directionalConv(<span class="var type1" id="S32T19U329">A</span>, <span class="mxinfo" id="T1:U3"><span class="mxinfo" id="T1:U4"><span class="var type1" id="S33T1U330">w</span></span></span>, <span class="mxinfo" id="T5:U6"><span class="mxinfo" id="T5:U7"><span class="var type1" id="S34T5U331">dir</span></span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,31">31</a></span><span class="line">    <span class="mxinfo" id="T5:U9">[<span class="var type1" id="S35T5U335">m</span>, <span class="var type1" id="S36T5U336">n</span>, <span class="var type1" id="S37T5U337">p</span>]=size(<span class="var type1" id="S32T19U340">A</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32">32</a></span><span class="line">    <span class="mxinfo" id="T5:U14"><span class="var type1" id="S39T5U343">q</span>=<span class="mxinfo" id="T5:U16">length(<span class="var type1" id="S33T1U346">w</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33">33</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S34T5U350">dir</span>==1   </span></span>
<span class="srcline"><span class="lineno"><a href="1,34">34</a></span><span class="line">        <span class="var type2" id="S31T0U354">B</span>=complex(zeros(<span class="var type2" id="S35T0U361">m</span>+<span class="var type2" id="S39T0U362">q</span>-1, <span class="var type2" id="S36T0U364">n</span>, <span class="var type2" id="S37T0U365">p</span>), 0);</span></span>
<span class="srcline"><span class="lineno"><a href="1,35">35</a></span><span class="line">        <span class="keyword">for</span> <span class="var type0" id="S43T0U369">j</span>=1:<span class="var type2" id="S36T0U372">n</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36">36</a></span><span class="line">            <span class="keyword">for</span> <span class="var type2" id="S44T0U375">k</span>=1:<span class="var type2" id="S37T0U378">p</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37">37</a></span><span class="line">                <span class="var type2" id="S45T0U381">v</span>=conv(squeeze(<span class="var type2" id="S32T0U387">A</span>(:, <span class="var type0" id="S43T0U389">j</span>, <span class="var type2" id="S44T0U390">k</span>)), <span class="var type2" id="S33T0U391">w</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,38">38</a></span><span class="line">                <span class="var type2" id="S31T0U395">B</span>(:, <span class="var type0" id="S43T0U397">j</span>, <span class="var type2" id="S44T0U398">k</span>)=<span class="var type2" id="S45T0U399">v</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39">39</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40">40</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41">41</a></span><span class="line">    <span class="keyword">elseif</span> <span class="var type1" id="S34T5U402">dir</span>==2</span></span>
<span class="srcline"><span class="lineno"><a href="1,42">42</a></span><span class="line">        <span class="mxinfo" id="T22:U20"><span class="var type1" id="S31T22U406">B</span>=<span class="mxinfo" id="T22:U22">complex(<span class="mxinfo" id="T32:U23">zeros(<span class="var type1" id="S35T5U411">m</span>, <span class="var type1" id="S36T5U414">n</span>+<span class="var type1" id="S39T5U415">q</span>-1, <span class="var type1" id="S37T5U417">p</span>)</span>, <span class="mxinfo" id="T5:U28">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,43">43</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S48T5U421">i</span>=<span class="mxinfo" id="T5:U30">1</span>:<span class="mxinfo" id="T5:U31"><span class="var type1" id="S35T5U424">m</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44">44</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S44T5U427">k</span>=<span class="mxinfo" id="T5:U34">1</span>:<span class="var type1" id="S37T5U430">p</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45">45</a></span><span class="line">                <span class="mxinfo" id="T21:U36"><span class="var type1" id="S45T21U433">v</span>=<span class="mxinfo" id="T21:U38">conv(<span class="mxinfo" id="T20:U39">squeeze(<span class="mxinfo" id="T20:U40"><span class="var type1" id="S32T19U439">A</span>(<span class="var type1" id="S48T5U440">i</span>, <span class="mxinfo" id="T33:U43">:</span>, <span class="var type1" id="S44T5U442">k</span>)</span>)</span>, <span class="mxinfo" id="T1:U45"><span class="var type1" id="S33T1U443">w</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,46">46</a></span><span class="line">                <span class="mxinfo" id="T21:U47"><span class="mxinfo" id="T21:U48"><span class="var type1" id="S31T22U447">B</span>(<span class="var type1" id="S48T5U448">i</span>, <span class="mxinfo" id="T34:U51">:</span>, <span class="var type1" id="S44T5U450">k</span>)</span>=<span class="var type1" id="S45T21U451">v</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47">47</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48">48</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49">49</a></span><span class="line">    <span class="keyword">elseif</span> <span class="var type2" id="S34T0U454">dir</span>==3 </span></span>
<span class="srcline"><span class="lineno"><a href="1,50">50</a></span><span class="line">        <span class="var type2" id="S31T0U458">B</span>=complex(zeros(<span class="var type2" id="S35T0U463">m</span>, <span class="var type2" id="S36T0U464">n</span>, <span class="var type2" id="S37T0U467">p</span>+<span class="var type2" id="S39T0U468">q</span>-1), 0);</span></span>
<span class="srcline"><span class="lineno"><a href="1,51">51</a></span><span class="line">        <span class="keyword">for</span> <span class="var type2" id="S48T0U473">i</span>=1:<span class="var type2" id="S35T0U476">m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52">52</a></span><span class="line">            <span class="keyword">for</span> <span class="var type0" id="S43T0U479">j</span>=1:<span class="var type2" id="S36T0U482">n</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53">53</a></span><span class="line">                <span class="var type2" id="S45T0U485">v</span>=conv(squeeze(<span class="var type2" id="S32T0U491">A</span>(<span class="var type2" id="S48T0U492">i</span>, <span class="var type0" id="S43T0U493">j</span>, :)), <span class="var type2" id="S33T0U495">w</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,54">54</a></span><span class="line">                <span class="var type2" id="S31T0U499">B</span>(<span class="var type2" id="S48T0U500">i</span>, <span class="var type0" id="S43T0U501">j</span>, :)=<span class="var type2" id="S45T0U503">v</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55">55</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56">56</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57">57</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58">58</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
