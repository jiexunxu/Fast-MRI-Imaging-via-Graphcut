<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,29">29</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,30">30</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S31T19U326">B</span>=directionalConv(<span class="var type1" id="S32T13U329">A</span>, <span class="mxinfo" id="T1:U3"><span class="mxinfo" id="T1:U4"><span class="var type1" id="S33T1U330">w</span></span></span>, <span class="mxinfo" id="T5:U6"><span class="mxinfo" id="T5:U7"><span class="var type1" id="S34T5U331">dir</span></span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,31">31</a></span><span class="line">    <span class="mxinfo" id="T5:U9">[<span class="var type1" id="S35T5U335">m</span>, <span class="var type1" id="S36T5U336">n</span>, <span class="var type1" id="S37T5U337">p</span>]=size(<span class="var type1" id="S32T13U340">A</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32">32</a></span><span class="line">    <span class="mxinfo" id="T5:U14"><span class="var type1" id="S39T5U343">q</span>=<span class="mxinfo" id="T5:U16">length(<span class="var type1" id="S33T1U346">w</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,33">33</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S34T5U350">dir</span>==1   </span></span>
<span class="srcline"><span class="lineno"><a href="1,34">34</a></span><span class="line">        <span class="mxinfo" id="T19:U19"><span class="var type1" id="S31T19U354">B</span>=<span class="mxinfo" id="T19:U21">complex(<span class="mxinfo" id="T29:U22">zeros(<span class="var type1" id="S35T5U361">m</span>+<span class="var type1" id="S39T5U362">q</span>-1, <span class="var type1" id="S36T5U364">n</span>, <span class="var type1" id="S37T5U365">p</span>)</span>, <span class="mxinfo" id="T5:U27">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35">35</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S43T5U369">j</span>=<span class="mxinfo" id="T5:U29">1</span>:<span class="mxinfo" id="T5:U30"><span class="var type1" id="S36T5U372">n</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36">36</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S44T5U375">k</span>=<span class="mxinfo" id="T5:U33">1</span>:<span class="var type1" id="S37T5U378">p</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37">37</a></span><span class="line">                <span class="mxinfo" id="T18:U35"><span class="var type1" id="S45T18U381">v</span>=<span class="mxinfo" id="T18:U37">conv(<span class="mxinfo" id="T14:U38">squeeze(<span class="mxinfo" id="T14:U39"><span class="var type1" id="S32T13U387">A</span>(<span class="mxinfo" id="T30:U41">:</span>, <span class="var type1" id="S43T5U389">j</span>, <span class="var type1" id="S44T5U390">k</span>)</span>)</span>, <span class="mxinfo" id="T1:U44"><span class="var type1" id="S33T1U391">w</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,38">38</a></span><span class="line">                <span class="mxinfo" id="T18:U46"><span class="mxinfo" id="T18:U47"><span class="var type1" id="S31T19U395">B</span>(<span class="mxinfo" id="T31:U49">:</span>, <span class="var type1" id="S43T5U397">j</span>, <span class="var type1" id="S44T5U398">k</span>)</span>=<span class="var type1" id="S45T18U399">v</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,39">39</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,40">40</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41">41</a></span><span class="line">    <span class="keyword">elseif</span> <span class="var type2" id="S34T0U402">dir</span>==2</span></span>
<span class="srcline"><span class="lineno"><a href="1,42">42</a></span><span class="line">        <span class="var type2" id="S31T0U406">B</span>=complex(zeros(<span class="var type2" id="S35T0U411">m</span>, <span class="var type2" id="S36T0U414">n</span>+<span class="var type2" id="S39T0U415">q</span>-1, <span class="var type2" id="S37T0U417">p</span>), 0);</span></span>
<span class="srcline"><span class="lineno"><a href="1,43">43</a></span><span class="line">        <span class="keyword">for</span> <span class="var type0" id="S48T0U421">i</span>=1:<span class="var type2" id="S35T0U424">m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,44">44</a></span><span class="line">            <span class="keyword">for</span> <span class="var type2" id="S44T0U427">k</span>=1:<span class="var type2" id="S37T0U430">p</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,45">45</a></span><span class="line">                <span class="var type2" id="S45T0U433">v</span>=conv(squeeze(<span class="var type2" id="S32T0U439">A</span>(<span class="var type0" id="S48T0U440">i</span>, :, <span class="var type2" id="S44T0U442">k</span>)), <span class="var type2" id="S33T0U443">w</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,46">46</a></span><span class="line">                <span class="var type2" id="S31T0U447">B</span>(<span class="var type0" id="S48T0U448">i</span>, :, <span class="var type2" id="S44T0U450">k</span>)=<span class="var type2" id="S45T0U451">v</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,47">47</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48">48</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49">49</a></span><span class="line">    <span class="keyword">elseif</span> <span class="var type2" id="S34T0U454">dir</span>==3 </span></span>
<span class="srcline"><span class="lineno"><a href="1,50">50</a></span><span class="line">        <span class="var type2" id="S31T0U458">B</span>=complex(zeros(<span class="var type2" id="S35T0U463">m</span>, <span class="var type2" id="S36T0U464">n</span>, <span class="var type2" id="S37T0U467">p</span>+<span class="var type2" id="S39T0U468">q</span>-1), 0);</span></span>
<span class="srcline"><span class="lineno"><a href="1,51">51</a></span><span class="line">        <span class="keyword">for</span> <span class="var type0" id="S48T0U473">i</span>=1:<span class="var type2" id="S35T0U476">m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52">52</a></span><span class="line">            <span class="keyword">for</span> <span class="var type2" id="S43T0U479">j</span>=1:<span class="var type2" id="S36T0U482">n</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53">53</a></span><span class="line">                <span class="var type2" id="S45T0U485">v</span>=conv(squeeze(<span class="var type2" id="S32T0U491">A</span>(<span class="var type0" id="S48T0U492">i</span>, <span class="var type2" id="S43T0U493">j</span>, :)), <span class="var type2" id="S33T0U495">w</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,54">54</a></span><span class="line">                <span class="var type2" id="S31T0U499">B</span>(<span class="var type0" id="S48T0U500">i</span>, <span class="var type2" id="S43T0U501">j</span>, :)=<span class="var type2" id="S45T0U503">v</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,55">55</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56">56</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57">57</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,58">58</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
