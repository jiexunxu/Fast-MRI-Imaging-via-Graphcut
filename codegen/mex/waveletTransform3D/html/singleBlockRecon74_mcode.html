<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,79"> 79</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,80"> 80</a></span><span class="line"><span class="comment">% Conv in z, y, x direction with w1, w2, w3</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81"> 81</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S66T23U746">B</span>=<span class="message warning" id="M4F74C">singleBlockRecon</span>(<span class="var type1" id="S67T14U749">A</span>, <span class="var type1" id="S68T2U750">w1</span>, <span class="var type1" id="S69T2U751">w2</span>, <span class="var type1" id="S70T2U752">w3</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,82"> 82</a></span><span class="line">    <span class="mxinfo" id="T6:U6">[<span class="var type1" id="S71T6U756">m</span>, <span class="var type1" id="S72T6U757">n</span>, <span class="var type1" id="S73T6U758">p</span>]=size(<span class="var type1" id="S67T14U761">A</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83"> 83</a></span><span class="line">    <span class="mxinfo" id="T6:U11"><span class="var type1" id="S75T6U764">q</span>=<span class="mxinfo" id="T6:U13">length(<span class="var type1" id="S68T2U767">w1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,84"> 84</a></span><span class="line">    <span class="mxinfo" id="T23:U15"><span class="var type1" id="S66T23U770">B</span>=<span class="mxinfo" id="T23:U17">complex(<span class="mxinfo" id="T27:U18">zeros(<span class="mxinfo" id="T6:U19"><span class="mxinfo" id="T6:U20"><span class="var type1" id="S71T6U777">m</span>+<span class="var type1" id="S75T6U778">q</span></span>-<span class="mxinfo" id="T6:U23">1</span></span>, <span class="mxinfo" id="T6:U24"><span class="mxinfo" id="T6:U25"><span class="var type1" id="S72T6U782">n</span>+<span class="var type1" id="S75T6U783">q</span></span>-<span class="mxinfo" id="T6:U28">1</span></span>, <span class="mxinfo" id="T6:U29"><span class="mxinfo" id="T6:U30"><span class="var type1" id="S73T6U787">p</span>+<span class="var type1" id="S75T6U788">q</span></span>-<span class="mxinfo" id="T6:U33">1</span></span>)</span>, <span class="mxinfo" id="T6:U34">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,85"> 85</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S79T6U793">i</span>=<span class="mxinfo" id="T6:U36">1</span>:<span class="mxinfo" id="T6:U37"><span class="var type1" id="S71T6U796">m</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86"> 86</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S80T6U799">j</span>=<span class="mxinfo" id="T6:U40">1</span>:<span class="mxinfo" id="T6:U41"><span class="var type1" id="S72T6U802">n</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,87"> 87</a></span><span class="line">            <span class="mxinfo" id="T19:U43"><span class="var type1" id="S81T19U805">v</span>=<span class="mxinfo" id="T19:U45">conv(<span class="mxinfo" id="T19:U46">squeeze(<span class="mxinfo" id="T24:U47"><span class="var type1" id="S67T14U811">A</span>(<span class="var type1" id="S79T6U812">i</span>, <span class="var type1" id="S80T6U813">j</span>, <span class="mxinfo" id="T36:U51">:</span>)</span>)</span>, <span class="var type1" id="S68T2U815">w1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,88"> 88</a></span><span class="line">            <span class="mxinfo" id="T24:U53"><span class="mxinfo" id="T24:U54"><span class="var type1" id="S66T23U819">B</span>(<span class="var type1" id="S79T6U820">i</span>, <span class="var type1" id="S80T6U821">j</span>, <span class="mxinfo" id="T36:U58">:</span>)</span>=<span class="var type1" id="S81T19U823">v</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,89"> 89</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90"> 90</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,91"> 91</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,92"> 92</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S79T6U826">i</span>=<span class="mxinfo" id="T6:U61">1</span>:<span class="mxinfo" id="T6:U62"><span class="var type1" id="S71T6U829">m</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,93"> 93</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S84T6U832">k</span>=<span class="mxinfo" id="T6:U65">1</span>:<span class="mxinfo" id="T6:U66"><span class="mxinfo" id="T6:U67"><span class="var type1" id="S73T6U837">p</span>+<span class="var type1" id="S75T6U838">q</span></span>-<span class="mxinfo" id="T6:U70">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,94"> 94</a></span><span class="line">            <span class="mxinfo" id="T22:U71"><span class="var type1" id="S81T22U842">v</span>=<span class="mxinfo" id="T22:U73">conv(<span class="mxinfo" id="T21:U74">squeeze(<span class="mxinfo" id="T21:U75"><span class="var type1" id="S66T23U848">B</span>(<span class="var type1" id="S79T6U849">i</span>, <span class="mxinfo" id="T45:U78"><span class="mxinfo" id="T6:U79">1</span>:<span class="mxinfo" id="T6:U80"><span class="var type1" id="S72T6U852">n</span></span></span>, <span class="var type1" id="S84T6U853">k</span>)</span>)</span>, <span class="var type1" id="S69T2U854">w2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95"> 95</a></span><span class="line">            <span class="mxinfo" id="T22:U84"><span class="mxinfo" id="T22:U85"><span class="var type1" id="S66T23U858">B</span>(<span class="var type1" id="S79T6U859">i</span>, <span class="mxinfo" id="T36:U88">:</span>, <span class="var type1" id="S84T6U861">k</span>)</span>=<span class="var type1" id="S81T22U862">v</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96"> 96</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97"> 97</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,98"> 98</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,99"> 99</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S80T6U865">j</span>=<span class="mxinfo" id="T6:U92">1</span>:<span class="mxinfo" id="T6:U93"><span class="mxinfo" id="T6:U94"><span class="var type1" id="S72T6U870">n</span>+<span class="var type1" id="S75T6U871">q</span></span>-<span class="mxinfo" id="T6:U97">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,100">100</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S84T6U875">k</span>=<span class="mxinfo" id="T6:U99">1</span>:<span class="mxinfo" id="T6:U100"><span class="mxinfo" id="T6:U101"><span class="var type1" id="S73T6U880">p</span>+<span class="var type1" id="S75T6U881">q</span></span>-<span class="mxinfo" id="T6:U104">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101">101</a></span><span class="line">            <span class="mxinfo" id="T19:U105"><span class="var type1" id="S81T19U885">v</span>=<span class="mxinfo" id="T19:U107">conv(<span class="mxinfo" id="T15:U108">squeeze(<span class="mxinfo" id="T15:U109"><span class="var type1" id="S66T23U891">B</span>(<span class="mxinfo" id="T46:U111"><span class="mxinfo" id="T6:U112">1</span>:<span class="mxinfo" id="T6:U113"><span class="var type1" id="S71T6U894">m</span></span></span>, <span class="var type1" id="S80T6U895">j</span>, <span class="var type1" id="S84T6U896">k</span>)</span>)</span>, <span class="var type1" id="S70T2U897">w3</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,102">102</a></span><span class="line">            <span class="mxinfo" id="T19:U118"><span class="mxinfo" id="T19:U119"><span class="var type1" id="S66T23U901">B</span>(<span class="mxinfo" id="T36:U121">:</span>, <span class="var type1" id="S80T6U903">j</span>, <span class="var type1" id="S84T6U904">k</span>)</span>=<span class="var type1" id="S81T19U905">v</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,103">103</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104">104</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,105">105</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
