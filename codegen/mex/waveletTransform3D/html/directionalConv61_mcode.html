<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,49"> 49</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,50"> 50</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S47T23U566">B</span>=directionalConv(<span class="var type1" id="S48T23U569">A</span>, <span class="var type1" id="S49T2U570">w</span>, <span class="mxinfo" id="T6:U4"><span class="mxinfo" id="T6:U5"><span class="var type1" id="S50T6U571">dir</span></span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,51"> 51</a></span><span class="line">    <span class="mxinfo" id="T6:U7">[<span class="var type1" id="S51T6U575">m</span>, <span class="var type1" id="S52T6U576">n</span>, <span class="var type1" id="S53T6U577">p</span>]=size(<span class="var type1" id="S48T23U580">A</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,52"> 52</a></span><span class="line">    <span class="mxinfo" id="T6:U12"><span class="var type1" id="S55T6U583">q</span>=<span class="mxinfo" id="T6:U14">length(<span class="var type1" id="S49T2U586">w</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,53"> 53</a></span><span class="line">    <span class="keyword">if</span> <span class="var type1" id="S50T6U590">dir</span>==1   </span></span>
<span class="srcline"><span class="lineno"><a href="1,54"> 54</a></span><span class="line">        <span class="var type2" id="S47T0U594">B</span>=complex(zeros(<span class="var type2" id="S51T0U601">m</span>+<span class="var type2" id="S55T0U602">q</span>-1, <span class="var type2" id="S52T0U604">n</span>, <span class="var type2" id="S53T0U605">p</span>), 0);</span></span>
<span class="srcline"><span class="lineno"><a href="1,55"> 55</a></span><span class="line">        <span class="keyword">for</span> <span class="var type2" id="S59T0U609">j</span>=1:<span class="var type2" id="S52T0U612">n</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,56"> 56</a></span><span class="line">            <span class="keyword">for</span> <span class="var type0" id="S60T0U615">k</span>=1:<span class="var type2" id="S53T0U618">p</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57"> 57</a></span><span class="line">                <span class="var type2" id="S61T0U621">v</span>=conv(squeeze(<span class="var type2" id="S48T0U627">A</span>(:, <span class="var type2" id="S59T0U629">j</span>, <span class="var type0" id="S60T0U630">k</span>)), <span class="var type2" id="S49T0U631">w</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,58"> 58</a></span><span class="line">                <span class="var type2" id="S47T0U635">B</span>(:, <span class="var type2" id="S59T0U637">j</span>, <span class="var type0" id="S60T0U638">k</span>)=<span class="var type2" id="S61T0U639">v</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,59"> 59</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,60"> 60</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,61"> 61</a></span><span class="line">    <span class="keyword">elseif</span> <span class="var type1" id="S50T6U642">dir</span>==2</span></span>
<span class="srcline"><span class="lineno"><a href="1,62"> 62</a></span><span class="line">        <span class="var type2" id="S47T0U646">B</span>=complex(zeros(<span class="var type2" id="S51T0U651">m</span>, <span class="var type2" id="S52T0U654">n</span>+<span class="var type2" id="S55T0U655">q</span>-1, <span class="var type2" id="S53T0U657">p</span>), 0);</span></span>
<span class="srcline"><span class="lineno"><a href="1,63"> 63</a></span><span class="line">        <span class="keyword">for</span> <span class="var type2" id="S64T0U661">i</span>=1:<span class="var type2" id="S51T0U664">m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64"> 64</a></span><span class="line">            <span class="keyword">for</span> <span class="var type0" id="S60T0U667">k</span>=1:<span class="var type2" id="S53T0U670">p</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65"> 65</a></span><span class="line">                <span class="var type2" id="S61T0U673">v</span>=conv(squeeze(<span class="var type2" id="S48T0U679">A</span>(<span class="var type2" id="S64T0U680">i</span>, :, <span class="var type0" id="S60T0U682">k</span>)), <span class="var type2" id="S49T0U683">w</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="1,66"> 66</a></span><span class="line">                <span class="var type2" id="S47T0U687">B</span>(<span class="var type2" id="S64T0U688">i</span>, :, <span class="var type0" id="S60T0U690">k</span>)=<span class="var type2" id="S61T0U691">v</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67"> 67</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68"> 68</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,69"> 69</a></span><span class="line">    <span class="keyword">elseif</span> <span class="var type1" id="S50T6U694">dir</span>==3 </span></span>
<span class="srcline"><span class="lineno"><a href="1,70"> 70</a></span><span class="line">        <span class="mxinfo" id="T23:U19"><span class="var type1" id="S47T23U698">B</span>=<span class="mxinfo" id="T23:U21">complex(<span class="mxinfo" id="T27:U22">zeros(<span class="var type1" id="S51T6U703">m</span>, <span class="var type1" id="S52T6U704">n</span>, <span class="mxinfo" id="T6:U25"><span class="mxinfo" id="T6:U26"><span class="var type1" id="S53T6U707">p</span>+<span class="var type1" id="S55T6U708">q</span></span>-<span class="mxinfo" id="T6:U29">1</span></span>)</span>, <span class="mxinfo" id="T6:U30">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,71"> 71</a></span><span class="line">        <span class="keyword">for</span> <span class="var type1" id="S64T6U713">i</span>=<span class="mxinfo" id="T6:U32">1</span>:<span class="var type1" id="S51T6U716">m</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,72"> 72</a></span><span class="line">            <span class="keyword">for</span> <span class="var type1" id="S59T6U719">j</span>=<span class="mxinfo" id="T6:U35">1</span>:<span class="var type1" id="S52T6U722">n</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73"> 73</a></span><span class="line">                <span class="mxinfo" id="T19:U37"><span class="var type1" id="S61T19U725">v</span>=<span class="mxinfo" id="T19:U39">conv(<span class="mxinfo" id="T19:U40">squeeze(<span class="mxinfo" id="T24:U41"><span class="var type1" id="S48T23U731">A</span>(<span class="var type1" id="S64T6U732">i</span>, <span class="var type1" id="S59T6U733">j</span>, <span class="mxinfo" id="T36:U45">:</span>)</span>)</span>, <span class="var type1" id="S49T2U735">w</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,74"> 74</a></span><span class="line">                <span class="mxinfo" id="T24:U47"><span class="mxinfo" id="T24:U48"><span class="var type1" id="S47T23U739">B</span>(<span class="var type1" id="S64T6U740">i</span>, <span class="var type1" id="S59T6U741">j</span>, <span class="mxinfo" id="T36:U52">:</span>)</span>=<span class="var type1" id="S61T19U743">v</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,75"> 75</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76"> 76</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77"> 77</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78"> 78</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,79"> 79</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,80"> 80</a></span><span class="line"><span class="comment">% Conv in z, y, x direction with w1, w2, w3</span></span></span>
</pre>
